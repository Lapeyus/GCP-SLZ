# ${var.owner} Projects Terraform State Buckets Documentation

This document explains the Terraform code responsible for creating and managing Google Cloud Storage buckets for ${var.owner} ingest, curated, and transformation projects.

## Overview

The code snippet consists of three distinct modules to create buckets for different types of ${var.owner} projects. Each module is parameterized to work with filtered folders and specific configurations.

## Local Variables

The code begins by defining local variables to filter out specific buckets for ingest, curated, and transformation.

```hcl
locals {
  filtered_ingest_buckets  = { for k, v in module.ingest_folders.id : k => v if k != "${var.owner}-Ingest" }
  filtered_curated_buckets = { for k, v in module.curated_folders.id : k => v if k != "${var.owner}-Cur" }
  filtered_trans_buckets   = { for k, v in module.trans_folders.id : k => v if k != "${var.owner}-Trans" }
}
```

## ${var.owner} Ingest Projects Terraform State Bucket

This module creates Google Cloud Storage buckets for ${var.owner} ingest projects, with specific permissions.

```hcl
module "${var.owner}_ingest_projects_tf_state" {
  for_each                 = local.filtered_ingest_buckets
  ...
  public_access_prevention = "enforced"
  iam_members = [
    {
      role   = "roles/storage.objectViewer"
      member = "serviceAccount:${google_service_account.main.email}"
    },
  ]
}
```

## ${var.owner} Curated Projects Terraform State Bucket

This module creates buckets for ${var.owner} curated projects, mirroring the configuration used for the ingest projects.

```hcl
module "${var.owner}_curated_projects_tf_state" {
  for_each                 = local.filtered_curated_buckets
  ...
  public_access_prevention = "enforced"
  ...
}
```

## ${var.owner} Transformation Projects Terraform State Bucket

Similar to the other two modules, this module creates transformation projects' buckets.

```hcl
module "${var.owner}_trans_projects_tf_state" {
  for_each                 = local.filtered_trans_buckets
  ...
  public_access_prevention = "enforced"
  ...
}
```

## Usage

Apply this code to create and manage ${var.owner} ingest, curated, and transformation projects' Google Cloud Storage buckets within your Google Cloud Platform organization.

---

!!! info
    From this point on the document is autogenerated, don't modify it directly

## Code

{% include 'code/bu-tfstate-buckets.code' %}
