# Altus Projects Terraform State Buckets Documentation

This document explains the Terraform code responsible for creating and managing Google Cloud Storage buckets for Altus ingest, curated, and transformation projects.

## Overview

The code snippet consists of three distinct modules to create buckets for different types of Altus projects. Each module is parameterized to work with filtered folders and specific configurations.

## Local Variables

The code begins by defining local variables to filter out specific buckets for ingest, curated, and transformation.

```hcl
locals {
  filtered_ingest_buckets  = { for k, v in module.ingest_folders.id : k => v if k != "Altus-Ingest" }
  filtered_curated_buckets = { for k, v in module.curated_folders.id : k => v if k != "Altus-Cur" }
  filtered_trans_buckets   = { for k, v in module.trans_folders.id : k => v if k != "Altus-Trans" }
}
```

## Altus Ingest Projects Terraform State Bucket

This module creates Google Cloud Storage buckets for Altus ingest projects, with specific permissions.

```hcl
module "altus_ingest_projects_tf_state" {
  for_each                 = local.filtered_ingest_buckets
  ...
  public_access_prevention = "enforced"
  iam_members = [
    {
      role   = "roles/storage.objectViewer"
      member = "serviceAccount:${google_service_account.service_account.email}"
    },
  ]
}
```

## Altus Curated Projects Terraform State Bucket

This module creates buckets for Altus curated projects, mirroring the configuration used for the ingest projects.

```hcl
module "altus_curated_projects_tf_state" {
  for_each                 = local.filtered_curated_buckets
  ...
  public_access_prevention = "enforced"
  ...
}
```

## Altus Transformation Projects Terraform State Bucket

Similar to the other two modules, this module creates transformation projects' buckets.

```hcl
module "altus_trans_projects_tf_state" {
  for_each                 = local.filtered_trans_buckets
  ...
  public_access_prevention = "enforced"
  ...
}
```

## Usage

Apply this code to create and manage Altus ingest, curated, and transformation projects' Google Cloud Storage buckets within your Google Cloud Platform organization.

---

!!! info
    From this point on the document is autogenerated, don't modify it directly

## Code

{% include 'code/bu-tfstate-buckets.code' %}
